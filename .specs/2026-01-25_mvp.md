# MVP: Solo Fuel Tracker + Blog

## Use Case

A single user who wants to:
1. Track their fuel consumption
2. Blog about their car

Simple, personal, free tier (Tender = User).

---

## User Stories

### Onboarding
- [ ] I create my account
- [ ] I add my car (make, model, year)

### Fuel Tracking
- [ ] I log a fill-up (liters, price, odometer, full tank?)
- [ ] I see my consumption history
- [ ] I see my average L/100km (or MPG)
- [ ] I see my fuel costs over time

### Blogging
- [ ] I write a story about my car
- [ ] I see my stories in a timeline
- [ ] Stories can have a title and body

### Timeline
- [ ] I see all passages (refuels + tales) in chronological order
- [ ] Each passage shows its type and summary

---

## Data Model (minimal)

```
users
  â””â”€> tenders (tenderable: User)
        â””â”€> croozers (croozable: Car)
              â””â”€> passages
                    â”œâ”€> refuels â›½
                    â””â”€> tales ðŸ“–
```

## Tables

| Table | Columns |
|-------|---------|
| `users` | id, email, password_digest, name, slug |
| `tenders` | id, tenderable_type, tenderable_id |
| `croozers` | id, name, slug, tender_id, croozable_type, croozable_id, reading_type, reading_unit |
| `cars` | id, make, model, year |
| `passages` | id, croozer_id, author_id, passageable_type, passageable_id, started_on, start_reading, end_reading |
| `refuels` | id, liters, price_cents, fuel_type, full_tank |
| `tales` | id, title, slug, body |

**7 tables total.**

---

## Calculations

### Consumption (L/100km)

```ruby
class Refuel < ApplicationRecord
  def consumption
    return nil unless full_tank && previous_full_tank
    
    distance = start_reading - previous_full_tank.start_reading
    return nil if distance <= 0
    
    (liters / distance) * 100
  end
  
  def previous_full_tank
    passage.croozer.passages.refuels
      .where(full_tank: true)
      .where("started_on < ?", passage.started_on)
      .order(started_on: :desc)
      .first
      &.passageable
  end
end
```

### Average consumption

```ruby
class Croozer < ApplicationRecord
  def average_consumption
    consumptions = passages.refuels.map(&:passageable).map(&:consumption).compact
    return nil if consumptions.empty?
    
    consumptions.sum / consumptions.size
  end
end
```

---

## Routes (draft)

```ruby
# config/routes.rb
resources :croozers do
  resources :passages, shallow: true
  
  # Convenience routes
  resources :refuels, controller: "passages", type: "Refuel"
  resources :tales, controller: "passages", type: "Tale"
end

# /croozers/:id          â†’ Garage (my car)
# /croozers/:id/passages â†’ Timeline
# /croozers/:id/refuels  â†’ Fuel log
# /croozers/:id/tales    â†’ Blog
```

---

## UI Screens (draft)

1. **Sign up / Sign in**
2. **Add car** â€” form: make, model, year, name
3. **Dashboard** â€” car card + stats + recent passages
4. **Log refuel** â€” form: date, liters, price, odometer, full tank?
5. **Fuel history** â€” list + chart
6. **Write tale** â€” form: title, body
7. **Tale view** â€” single tale page
8. **Timeline** â€” mixed feed of all passages

---

## Out of Scope (V1)

- Crews / Clubs (multi-owner)
- Other passageables (services, tires, etc.)
- Other croozables (motorcycles, boats, planes)
- Photos/attachments
- Social features (following, comments)
- Public profiles
- Mobile app

---

## Success Criteria

1. âœ… User can sign up and add a car
2. âœ… User can log refuels and see consumption
3. âœ… User can write and read tales
4. âœ… Timeline shows both types mixed
5. âœ… Architecture validated (delegated_type works)
